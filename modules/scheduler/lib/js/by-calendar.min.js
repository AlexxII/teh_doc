!function(y){function n(e,t){this.element=e,this.element.addClass("calendar"),this._initializeEvents(t),this._initializeOptions(t),this.setYear(this.options.startYear)}n.prototype={constructor:n,_initializeOptions:function(e){null==e&&(e=[]),this.options={startYear:isNaN(parseInt(e.startYear))?(new Date).getFullYear():parseInt(e.startYear),minDate:e.minDate instanceof Date?e.minDate:null,maxDate:e.maxDate instanceof Date?e.maxDate:null,language:null!=e.language&&null!=v[e.language]?e.language:"en",allowOverlap:null==e.allowOverlap||e.allowOverlap,displayWeekNumber:null!=e.displayWeekNumber&&e.displayWeekNumber,displayDisabledDataSource:null!=e.displayDisabledDataSource&&e.displayDisabledDataSource,displayHeader:null==e.displayHeader||e.displayHeader,alwaysHalfDay:null!=e.alwaysHalfDay&&e.alwaysHalfDay,enableRangeSelection:null!=e.enableRangeSelection&&e.enableRangeSelection,disabledDays:e.disabledDays instanceof Array?e.disabledDays:[],disabledWeekDays:e.disabledWeekDays instanceof Array?e.disabledWeekDays:[],hiddenWeekDays:e.hiddenWeekDays instanceof Array?e.hiddenWeekDays:[],roundRangeLimits:null!=e.roundRangeLimits&&e.roundRangeLimits,dataSource:e.dataSource instanceof Array?e.dataSource:[],style:"background"==e.style||"border"==e.style||"custom"==e.style?e.style:"border",enableContextMenu:null!=e.enableContextMenu&&e.enableContextMenu,contextMenuItems:e.contextMenuItems instanceof Array?e.contextMenuItems:[],customDayRenderer:y.isFunction(e.customDayRenderer)?e.customDayRenderer:null,customDataSourceRenderer:y.isFunction(e.customDataSourceRenderer)?e.customDataSourceRenderer:null,weekStart:isNaN(parseInt(e.weekStart))?null:parseInt(e.weekStart)},this._initializeDatasourceColors()},_initializeEvents:function(e){null==e&&(e=[]),e.yearChanged&&this.element.bind("yearChanged",e.yearChanged),e.renderEnd&&this.element.bind("renderEnd",e.renderEnd),e.clickDay&&this.element.bind("clickDay",e.clickDay),e.clickMonth&&this.element.bind("clickMonth",e.clickMonth),e.dayContextMenu&&this.element.bind("dayContextMenu",e.dayContextMenu),e.selectRange&&this.element.bind("selectRange",e.selectRange),e.mouseOnDay&&this.element.bind("mouseOnDay",e.mouseOnDay),e.mouseOutDay&&this.element.bind("mouseOutDay",e.mouseOutDay)},_initializeDatasourceColors:function(){for(var e=0;e<this.options.dataSource.length;e++)null==this.options.dataSource[e].color&&(this.options.dataSource[e].color=t[e%t.length])},render:function(){this.element.empty(),this.options.displayHeader&&this._renderHeader(),this._renderBody(),this._renderDataSource(),this._applyEvents(),this.element.find(".months-container").fadeIn(500),this._triggerEvent("renderEnd",{currentYear:this.options.startYear})},_renderHeader:function(){var e=y(document.createElement("div"));e.addClass("calendar-header panel panel-default");var t=y(document.createElement("table")),n=y(document.createElement("th"));n.addClass("prev"),null!=this.options.minDate&&this.options.minDate>new Date(this.options.startYear-1,11,31)&&n.addClass("disabled");var a=y(document.createElement("span"));a.addClass("glyphicon glyphicon-chevron-left"),n.append(a),t.append(n);var s=y(document.createElement("th"));s.addClass("year-title year-neighbor2 hidden-sm hidden-xs"),s.text(this.options.startYear-2),null!=this.options.minDate&&this.options.minDate>new Date(this.options.startYear-2,11,31)&&s.addClass("disabled"),t.append(s);var i=y(document.createElement("th"));i.addClass("year-title year-neighbor hidden-xs"),i.text(this.options.startYear-1),null!=this.options.minDate&&this.options.minDate>new Date(this.options.startYear-1,11,31)&&i.addClass("disabled"),t.append(i);var o=y(document.createElement("th"));o.addClass("year-title"),o.text(this.options.startYear),t.append(o);var r=y(document.createElement("th"));r.addClass("year-title year-neighbor hidden-xs"),r.text(this.options.startYear+1),null!=this.options.maxDate&&this.options.maxDate<new Date(this.options.startYear+1,0,1)&&r.addClass("disabled"),t.append(r);var d=y(document.createElement("th"));d.addClass("year-title year-neighbor2 hidden-sm hidden-xs"),d.text(this.options.startYear+2),null!=this.options.maxDate&&this.options.maxDate<new Date(this.options.startYear+2,0,1)&&d.addClass("disabled"),t.append(d);var l=y(document.createElement("th"));l.addClass("next"),null!=this.options.maxDate&&this.options.maxDate<new Date(this.options.startYear+1,0,1)&&l.addClass("disabled");var c=y(document.createElement("span"));c.addClass("glyphicon glyphicon-chevron-right"),l.append(c),t.append(l),e.append(t),this.element.append(e)},_renderBody:function(){var e=y(document.createElement("div"));e.addClass("months-container");for(var t=0;t<12;t++){var n=y(document.createElement("div"));n.addClass("month-container"),n.data("month-id",t);var a=new Date(this.options.startYear,t,1),s=y(document.createElement("table"));s.addClass("month");var i=y(document.createElement("thead")),o=y(document.createElement("tr")),r=y(document.createElement("th"));r.addClass("month-title"),r.attr("colspan",this.options.displayWeekNumber?8:7),r.text(v[this.options.language].months[t]),o.append(r),i.append(o);var d=y(document.createElement("tr"));if(this.options.displayWeekNumber)(m=y(document.createElement("th"))).addClass("week-number"),m.text(v[this.options.language].weekShort),d.append(m);var l=this.options.weekStart?this.options.weekStart:v[this.options.language].weekStart,c=l;do{var u=y(document.createElement("th"));u.addClass("day-header"),u.text(v[this.options.language].daysMin[c]),this._isHidden(c)&&u.addClass("hidden"),d.append(u),7<=++c&&(c=0)}while(c!=l);i.append(d),s.append(i);for(var h=new Date(a.getTime()),p=new Date(this.options.startYear,t+1,0);h.getDay()!=l;)h.setDate(h.getDate()-1);for(;h<=p;){var m,g=y(document.createElement("tr"));if(this.options.displayWeekNumber)(m=y(document.createElement("td"))).addClass("week-number"),m.text(this.getWeekNumber(h)),g.append(m);do{var D=y(document.createElement("td"));if(D.addClass("day"),this._isHidden(h.getDay())&&D.addClass("hidden"),h<a)D.addClass("old");else if(p<h)D.addClass("new");else{this._isDisabled(h)&&D.addClass("disabled");var f=y(document.createElement("div"));f.addClass("day-content"),f.text(h.getDate()),D.append(f),this.options.customDayRenderer&&this.options.customDayRenderer(f,h)}g.append(D),h.setDate(h.getDate()+1)}while(h.getDay()!=l);s.append(g)}n.append(s),e.append(n)}this.element.append(e)},_renderDataSource:function(){var o=this;null!=this.options.dataSource&&0<this.options.dataSource.length&&this.element.find(".month-container").each(function(){var s=y(this).data("month-id"),e=new Date(o.options.startYear,s,1),t=new Date(o.options.startYear,s+1,1);if((null==o.options.minDate||t>o.options.minDate)&&(null==o.options.maxDate||e<=o.options.maxDate)){for(var i=[],n=0;n<o.options.dataSource.length;n++)o.options.dataSource[n].startDate>=t&&!(o.options.dataSource[n].endDate<e)||i.push(o.options.dataSource[n]);0<i.length&&y(this).find(".day-content").each(function(){var e=new Date(o.options.startYear,s,y(this).text()),t=new Date(o.options.startYear,s,e.getDate()+1),n=[];if((null==o.options.minDate||e>=o.options.minDate)&&(null==o.options.maxDate||e<=o.options.maxDate)){for(var a=0;a<i.length;a++)i[a].startDate<t&&i[a].endDate>=e&&n.push(i[a]);0<n.length&&(o.options.displayDisabledDataSource||!o._isDisabled(e))&&o._renderDataSourceDay(y(this),e,n)}})}})},_renderDataSourceDay:function(e,t,n){switch(this.options.style){case"border":var a=0;if(1==n.length?a=4:n.length<=3?a=2:e.parent().css("box-shadow","inset 0 -4px 0 0 black"),0<a){for(var s="",i=0;i<n.length;i++)""!=s&&(s+=","),s+="inset 0 -"+(parseInt(i)+1)*a+"px 0 0 "+n[i].color;e.parent().css("box-shadow",s)}break;case"background":e.parent().css("background-color",n[n.length-1].color);var o=t.getTime();if(n[n.length-1].startDate.getTime()==o)if(e.parent().addClass("day-start"),n[n.length-1].startHalfDay||this.options.alwaysHalfDay){e.parent().addClass("day-half");var r="transparent";for(i=n.length-2;0<=i;i--)if(n[i].startDate.getTime()!=o||!n[i].startHalfDay&&!this.options.alwaysHalfDay){r=n[i].color;break}e.parent().css("background","linear-gradient(-45deg, "+n[n.length-1].color+", "+n[n.length-1].color+" 49%, "+r+" 51%, "+r+")")}else this.options.roundRangeLimits&&e.parent().addClass("round-left");else if(n[n.length-1].endDate.getTime()==o)if(e.parent().addClass("day-end"),n[n.length-1].endHalfDay||this.options.alwaysHalfDay){e.parent().addClass("day-half");for(r="transparent",i=n.length-2;0<=i;i--)if(n[i].endDate.getTime()!=o||!n[i].endHalfDay&&!this.options.alwaysHalfDay){r=n[i].color;break}e.parent().css("background","linear-gradient(135deg, "+n[n.length-1].color+", "+n[n.length-1].color+" 49%, "+r+" 51%, "+r+")")}else this.options.roundRangeLimits&&e.parent().addClass("round-right");break;case"custom":this.options.customDataSourceRenderer&&this.options.customDataSourceRenderer.call(this,e,t,n)}},_applyEvents:function(){var i=this;this.element.find(".year-neighbor, .year-neighbor2").click(function(){y(this).hasClass("disabled")||i.setYear(parseInt(y(this).text()))}),this.element.find(".calendar-header .prev").click(function(){y(this).hasClass("disabled")||i.element.find(".months-container").animate({"margin-left":"100%"},100,function(){i.element.find(".months-container").css("visibility","hidden"),i.element.find(".months-container").css("margin-left","0"),setTimeout(function(){i.setYear(i.options.startYear-1)},50)})}),this.element.find(".calendar-header .next").click(function(){y(this).hasClass("disabled")||i.element.find(".months-container").animate({"margin-left":"-100%"},100,function(){i.element.find(".months-container").css("visibility","hidden"),i.element.find(".months-container").css("margin-left","0"),setTimeout(function(){i.setYear(i.options.startYear+1)},50)})});var e=this.element.find(".day:not(.old, .new, .disabled)");e.click(function(e){e.stopPropagation();var t=i._getDate(y(this));i._triggerEvent("clickDay",{element:y(this),which:e.which,date:t,events:i.getEvents(t)})}),this.element.find(".month-title:not(.old, .new, .disabled)").click(function(e){e.stopPropagation();var t=i._getDateEx(y(this));i._triggerEvent("clickMonth",{event:e,element:y(this),which:e.which,date:t,events:i.getEvents(t)})}),e.bind("contextmenu",function(e){i.options.enableContextMenu&&(e.preventDefault(),0<i.options.contextMenuItems.length&&i._openContextMenu(y(this)));var t=i._getDate(y(this));i._triggerEvent("dayContextMenu",{element:y(this),date:t,events:i.getEvents(t)})}),this.options.enableRangeSelection&&(e.mousedown(function(e){if(1==e.which){var t=i._getDate(y(this));!i.options.allowOverlap&&0!=i.getEvents(t).length||(i._mouseDown=!0,i._rangeStart=i._rangeEnd=t,i._refreshRange())}}),e.mouseenter(function(e){if(i._mouseDown){var t=i._getDate(y(this));if(!i.options.allowOverlap){var n=new Date(i._rangeStart.getTime());if(n<t)for(var a=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1);n<t&&!(0<i.getEvents(a).length);)n.setDate(n.getDate()+1),a.setDate(a.getDate()+1);else for(a=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1);t<n&&!(0<i.getEvents(a).length);)n.setDate(n.getDate()-1),a.setDate(a.getDate()-1);t=n}var s=i._rangeEnd;i._rangeEnd=t,s.getTime()!=i._rangeEnd.getTime()&&i._refreshRange()}}),y(window).mouseup(function(e){if(i._mouseDown){i._mouseDown=!1,i._refreshRange();var t=i._rangeStart<i._rangeEnd?i._rangeStart:i._rangeEnd,n=i._rangeEnd>i._rangeStart?i._rangeEnd:i._rangeStart;i._triggerEvent("selectRange",{startDate:t,endDate:n,events:i.getEventsOnRange(t,new Date(n.getFullYear(),n.getMonth(),n.getDate()+1))})}})),e.mouseenter(function(e){if(!i._mouseDown){var t=i._getDate(y(this));i._triggerEvent("mouseOnDay",{element:y(this),date:t,events:i.getEvents(t)})}}),e.mouseleave(function(e){var t=i._getDate(y(this));i._triggerEvent("mouseOutDay",{element:y(this),date:t,events:i.getEvents(t)})}),setInterval(function(){var e=y(i.element).width(),t=y(i.element).find(".month").first().width()+10,n="month-container";n+=6*t<e?" col-xs-2":4*t<e?" col-xs-3":3*t<e?" col-xs-4":2*t<e?" col-xs-6":" col-xs-12",y(i.element).find(".month-container").attr("class",n)},300)},_refreshRange:function(){var t=this;if(this.element.find("td.day.range").removeClass("range"),this.element.find("td.day.range-start").removeClass("range-start"),this.element.find("td.day.range-end").removeClass("range-end"),this._mouseDown){var n=t._rangeStart<t._rangeEnd?t._rangeStart:t._rangeEnd,a=t._rangeEnd>t._rangeStart?t._rangeEnd:t._rangeStart;this.element.find(".month-container").each(function(){var e=y(this).data("month-id");n.getMonth()<=e&&a.getMonth()>=e&&y(this).find("td.day:not(.old, .new)").each(function(){var e=t._getDate(y(this));n<=e&&e<=a&&(y(this).addClass("range"),e.getTime()==n.getTime()&&y(this).addClass("range-start"),e.getTime()==a.getTime()&&y(this).addClass("range-end"))})})}},_openContextMenu:function(e){var t=y(".calendar-context-menu");0<t.length?(t.hide(),t.empty()):((t=y(document.createElement("div"))).addClass("calendar-context-menu"),y("body").append(t));for(var n=this._getDate(e),a=this.getEvents(n),s=0;s<a.length;s++){var i=y(document.createElement("div"));i.addClass("item"),i.css("border-left","4px solid "+a[s].color);var o=y(document.createElement("div"));o.addClass("content"),o.text(a[s].name),i.append(o);var r=y(document.createElement("span"));r.addClass("glyphicon glyphicon-chevron-right"),i.append(r),this._renderContextMenuItems(i,this.options.contextMenuItems,a[s]),t.append(i)}0<t.children().length&&(t.css("left",e.offset().left+25+"px"),t.css("top",e.offset().top+25+"px"),t.show(),y(window).one("mouseup",function(){t.hide()}))},_renderContextMenuItems:function(e,t,n){var a=y(document.createElement("div"));a.addClass("submenu");for(var s=0;s<t.length;s++)if(!t[s].visible||t[s].visible(n)){var i=y(document.createElement("div"));i.addClass("item");var o=y(document.createElement("div"));o.addClass("content"),o.text(t[s].text),i.append(o),t[s].click&&function(e){i.click(function(){t[e].click(n)})}(s);var r=y(document.createElement("span"));r.addClass("glyphicon glyphicon-chevron-right"),i.append(r),t[s].items&&0<t[s].items.length&&this._renderContextMenuItems(i,t[s].items,n),a.append(i)}0<a.children().length&&e.append(a)},_getColor:function(e){y("<div />").css("color",e)},_getDate:function(e){var t=e.children(".day-content").text(),n=e.closest(".month-container").data("month-id"),a=this.options.startYear;return new Date(a,n,t)},_getDateEx:function(e){var t=e.closest(".month-container").data("month-id"),n=this.options.startYear;return new Date(n,t,"1")},_triggerEvent:function(e,t){var n=y.Event(e);for(var a in t)n[a]=t[a];return this.element.trigger(n),n},_isDisabled:function(e){if(null!=this.options.minDate&&e<this.options.minDate||null!=this.options.maxDate&&e>this.options.maxDate)return!0;if(0<this.options.disabledWeekDays.length)for(var t=0;t<this.options.disabledWeekDays.length;t++)if(e.getDay()==this.options.disabledWeekDays[t])return!0;if(0<this.options.disabledDays.length)for(t=0;t<this.options.disabledDays.length;t++)if(e.getTime()==this.options.disabledDays[t].getTime())return!0;return!1},_isHidden:function(e){if(0<this.options.hiddenWeekDays.length)for(var t=0;t<this.options.hiddenWeekDays.length;t++)if(e==this.options.hiddenWeekDays[t])return!0;return!1},getWeekNumber:function(e){var t=new Date(e.getTime());t.setHours(0,0,0,0),t.setDate(t.getDate()+3-(t.getDay()+6)%7);var n=new Date(t.getFullYear(),0,4);return 1+Math.round(((t.getTime()-n.getTime())/864e5-3+(n.getDay()+6)%7)/7)},getEvents:function(e){return this.getEventsOnRange(e,new Date(e.getFullYear(),e.getMonth(),e.getDate()+1))},getEventsOnRange:function(e,t){var n=[];if(this.options.dataSource&&e&&t)for(var a=0;a<this.options.dataSource.length;a++)this.options.dataSource[a].startDate<t&&this.options.dataSource[a].endDate>=e&&n.push(this.options.dataSource[a]);return n},getYear:function(){return this.options.startYear},setYear:function(e){var t=parseInt(e);isNaN(t)||(this.options.startYear=t,this.element.empty(),this.options.displayHeader&&this._renderHeader(),this._triggerEvent("yearChanged",{currentYear:this.options.startYear,preventRendering:!1}).preventRendering||this.render())},getMinDate:function(){return this.options.minDate},setMinDate:function(e,t){e instanceof Date&&(this.options.minDate=e,t||this.render())},getMaxDate:function(){return this.options.maxDate},setMaxDate:function(e,t){e instanceof Date&&(this.options.maxDate=e,t||this.render())},getStyle:function(){return this.options.style},setStyle:function(e,t){this.options.style="background"==e||"border"==e||"custom"==e?e:"border",t||this.render()},getAllowOverlap:function(){return this.options.allowOverlap},setAllowOverlap:function(e){this.options.allowOverlap=e},getDisplayWeekNumber:function(){return this.options.displayWeekNumber},setDisplayWeekNumber:function(e,t){this.options.displayWeekNumber=e,t||this.render()},getDisplayHeader:function(){return this.options.displayHeader},setDisplayHeader:function(e,t){this.options.displayHeader=e,t||this.render()},getDisplayDisabledDataSource:function(){return this.options.displayDisabledDataSource},setDisplayDisabledDataSource:function(e,t){this.options.displayDisabledDataSource=e,t||this.render()},getAlwaysHalfDay:function(){return this.options.alwaysHalfDay},setAlwaysHalfDay:function(e,t){this.options.alwaysHalfDay=e,t||this.render()},getEnableRangeSelection:function(){return this.options.enableRangeSelection},setEnableRangeSelection:function(e,t){this.options.enableRangeSelection=e,t||this.render()},getDisabledDays:function(){return this.options.disabledDays},setDisabledDays:function(e,t){this.options.disabledDays=e instanceof Array?e:[],t||this.render()},getDisabledWeekDays:function(){return this.options.disabledWeekDays},setDisabledWeekDays:function(e,t){this.options.disabledWeekDays=e instanceof Array?e:[],t||this.render()},getHiddenWeekDays:function(){return this.options.hiddenWeekDays},setHiddenWeekDays:function(e,t){this.options.hiddenWeekDays=e instanceof Array?e:[],t||this.render()},getRoundRangeLimits:function(){return this.options.roundRangeLimits},setRoundRangeLimits:function(e,t){this.options.roundRangeLimits=e,t||this.render()},getEnableContextMenu:function(){return this.options.enableContextMenu},setEnableContextMenu:function(e,t){this.options.enableContextMenu=e,t||this.render()},getContextMenuItems:function(){return this.options.contextMenuItems},setContextMenuItems:function(e,t){this.options.contextMenuItems=e instanceof Array?e:[],t||this.render()},getCustomDayRenderer:function(){return this.options.customDayRenderer},setCustomDayRenderer:function(e,t){this.options.customDayRenderer=y.isFunction(e)?e:null,t||this.render()},getCustomDataSourceRenderer:function(){return this.options.customDataSourceRenderer},setCustomDataSourceRenderer:function(e,t){this.options.customDataSourceRenderer=y.isFunction(e)?e:null,t||this.render()},getLanguage:function(){return this.options.language},setLanguage:function(e,t){null!=e&&null!=v[e]&&(this.options.language=e,t||this.render())},getDataSource:function(){return this.options.dataSource},setDataSource:function(e,t){this.options.dataSource=e instanceof Array?e:[],this._initializeDatasourceColors(),t||this.render()},getWeekStart:function(){return this.options.weekStart?this.options.weekStart:v[this.options.language].weekStart},setWeekStart:function(e,t){this.options.weekStart=isNaN(parseInt(e))?null:parseInt(e),t||this.render()},addEvent:function(e,t){this.options.dataSource.push(e),t||this.render()}},y.fn.calendar=function(e){var t=new n(y(this),e);return y(this).data("calendar",t),t},y.fn.yearChanged=function(e){y(this).bind("yearChanged",e)},y.fn.renderEnd=function(e){y(this).bind("renderEnd",e)},y.fn.clickDay=function(e){y(this).bind("clickDay",e)},y.fn.clickMonth=function(e){y(this).bind("clickMonth",e)},y.fn.dayContextMenu=function(e){y(this).bind("dayContextMenu",e)},y.fn.selectRange=function(e){y(this).bind("selectRange",e)},y.fn.mouseOnDay=function(e){y(this).bind("mouseOnDay",e)},y.fn.mouseOutDay=function(e){y(this).bind("mouseOutDay",e)};var v=y.fn.calendar.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],weekShort:"W",weekStart:0}},t=y.fn.calendar.colors=["#2C8FC9","#9CB703","#F5BB00","#FF4A32","#B56CE2","#45A597"];y(function(){y('[data-provide="calendar"]').each(function(){y(this).calendar()})})}(window.jQuery);